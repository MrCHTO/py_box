#  第一章 概述
## 1 - 计算机网络在信息时代的作用
* 三网融合：电信网络、有线电视网络、计算机网络。
* 计算机网络最重要的功能：连通性、资源共享（信息共享、软件共享、硬件共享）。
## 2 - 互联网的概述
* 网络之间通过路由器互连起来，形成覆盖范围更大的网络。
* 前身是美国国防部与1969年创建的ARPANET（单一分组交换网）。
* TCP/IP成为标准协议，用于网络互连，形成互联网，诞生时间为1983年。
### 2.1 - 计算机网络
* 由若干**结点**(node)和连接这些结点的**链路**(link)组成。
* 结点可以是计算机、集线器、交换机或路由器等设备。
### 2.2 - 互联网的组成
#### 2.2.1 - 边缘部分
* 由所有连接在互联网上的主机组成。
* 用户直接使用，进行通信，资源共享。
##### 通信方式
* （C/S）方式：（客户/服务器）方式。
    * 客户程序
        * 必须知道服务器程序的地址。
        * 不需要特殊的硬件和复杂的操作系统。 
    * 服务器程序 
        * 自动调用，被动等待并且接受通讯请求。
        * 同时处理多个地方的客户请求。
        * 需要强大的硬件和高级的操作系统。
* （P2P）方式：对等方式。
    * 只要两个主机都运行了对等连接软件（P2P 软件），它们就可以进行平等的、对等连接通信。双方都可以下载对方已经存储在硬盘中的共享文档。 
#### 2.2.2 - 核心部分
* 作用：为边缘部分提供连通性和交换服务。
* 主体：路由器。
* 组建：分组交换网络。
##### 数据交换方式
* 电路交换：电话系统（独占线路）必须先建立物理连接通路再通信（实时通讯）。
* 分组交换：互联网（以分组为单位的存储转发方式）。
    * 基本原理
        * 在发送端，先把较长的报文划分成较短的、固定长度的数据段。
        * 在每一个数据段前面添加上首部构成分组。
        * 以“分组”作为数据传输单元，依次把各分组发送到接收端。
        * 接收端收到分组后剥去首部还原成报文。
    * 优点：
        * 计算机之间的多路通信可以并行进行。
        * 存储转发技术可以实现对链路的逐段占用，不必先建立连接。
    * 缺点：
        * 分组在各结点存储转发时需要排队，这就会造成一定的时延 。
        * 分组必须携带的首部（里面有必不可少的控制信息）造成了一定的开销。
* 报文交换：电报系统（整个报文以存储转发方式通信）。
### 2.3 - 缩写全称
* Internet：泛指互连的网络，这些网络使用的协议不一定是TCP/IP。
* INTERNET：专指当前全球最大的、开放的国际互联网，它采用TCP/IP协议族作为通信规则。
* ISO：国际标准化组织(international standards organization)。
* IEEE：电器和电子工程师协会(institute of electrical and electronics engineers)
* I SOC：互联网协会(Internet society)
## 3 - 计算机网络的概述
### 3.1 - 计算机网络的类别
#### 3.1.1 - 广域网
* 范围：大，＞100km。
* 传输技术：宽带，延迟大，出错率高。
* 拓扑结构：不规则，点到点。
#### 3.1.2 - 域域网
* 范围：中等，＜100km。
* 传输技术：宽带/基带。
* 拓扑结构：总线。
#### 3.1.3 - 局域网
* 范围：小，1km左右。
* 传输技术：基带，10Mb/s~1000Mb/s，延迟低，出错率低（10^-11^）。
* 拓扑结构：总线，环。
#### 3.1.4 - 个人区域网
* 范围：10m左右（ADSL）。
### 3.2 - 计算机网络的性能
#### 3.2.1 - 速率
* 比特（bit）是计算机中数据量的单位，也是信息论中使用的信息量的单位。
* bit 来源于 binary digit，意思是一个“二进制数字”，因此一个比特就是二进制数字中的一个 1 或 0。
* 速率即数据率(data rate)或比特率(bit rate)是计算机网络中最重要的一个性能指标。速率的单位是 b/s，或KB/s, Mb/s, GB/s 等。
* 速率往往是指额定速率或标称速率。
* 
>KB/s （10^3^ b/s）
>Mb/s（10^6^ b/s）
>GB/s（10^9^ b/s）
>Tb/s（10^12^ b/s）

#### 3.2.2 - 带宽
* 通信采用模拟信号
    * 信号具有的频带宽度，单位是赫（或千赫、兆赫、吉赫等）。
* 通信采用数字信号
    * 网络的通信线路所能传送数据的能力，即单位时间从网络中某一点到另一点所能通过的**“最高数据率”**。
#### 3.2.3 - 吞吐量
* 在单位时间内通过某个网络（或信道、接口）的实际的数据量。
* 吞吐量受网络的带宽或网络的额定速率的限制。
#### 3.2.4 - 时延
* 是指数据（一个报文或分组）从网络的一端传送到另一端所需的时间。
* 总时延 = 发送时延+传播时延+处理时延+排队时延
##### 发送时延
* 主机或路由器发送数据帧所需要的时间，也就是从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完毕所需的时间。
* 发送时延 = 数据块长度（比特） / 发送速率（比特/秒）
##### 传播时延
* 电磁波在信道中需要传播一定的距离而花费的时间。
* 传播时延 = 信道长度（米）/ 信号在信道上的传播速率（米/秒） 
##### 时延带宽积
* 称为以比特为单位的链路长度。
* 一条链路的时延带宽积就是这条链路上具有的比特数的最大值。
* 时延带宽积 = 传播时延 * 带宽
#### 3.2.5 - 网络性能指标
* 利用率、可靠性、标准化、可扩展性、可维护性、管理。
* D = D~0~ / 1 - U
$$D = \frac{D^0}{1-U}$$
    * D：表示网络当前的时延。
    * D~0~：表示网络空闲时的时延。
    * U：表示信道利用率。

>随着利用率增加，时延急剧增大。 

### 3.3 - 计算机网络的体系结构
* 采用分层结构。
* 体系结构定义：计算机网络的各层及其协议的集合。
#### 3.3.1 - 网络协议
* 为进行网络中的数据交而建立的规则标准或者约定。
* 三要素：语法、语义、同步。
#### 3.3.2 - OS I 七层体系结构
* 应用层、表示层、会话层、传输层、网络层、数据链路层、物理层。

![image-20200914205208855](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200914205208855.png)

#### 3.3.3 - TCP/IP 四层体系结构
* 应用层、运输层、网络层、网络接口层 	

![image-20200914205436421](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200914205436421.png)

#### 3.3.4 - 学习研究 五层体系结构

![image-20200914205544723](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200914205544723.png)

##### 应用层（数据）
* 直接为用户应用进程提供服务。
##### 运输层（分段）
* 负责向两个主机中进程之间的通信提供服务。
* 主要协议
    * TCP（传输控制协议）：面向连接的，数据传输的单位是报文段，能够提供可靠的交付。
    * UDP（用户数据报协议）：无连接的，数据传输的单位是用户数据报，不保证可靠的交付，尽最大能力交付。
##### 网络层（数据包）
* 负责为分组交换网上的不同主机提供通信服务。
* 发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组或包（IP数据报）进行传送。
* 网络层另一个任务是选择合适的路由，使源主机运输层所传下来的分组，能够通过网络中的路由器找到目的主机。
* 因特网主要的网络层协议是IP协议和各种路由协议。
##### 数据链路层（帧）
* 把网络层交下来的IP数据报组装成帧，在两个相邻结点间的链路上“透明”地传送帧数据。
* 接收数据时，控制信息能够检测差错，找出帧的起始和结束位置，使接收端能够提取出数据部分上交给网络层。
##### 物理层（比特位）
* 任务是透明地传送比特流。
* 描述网络硬件接口的机械、电气、功能、过程特性：如多少针 (25针、9针等)，每针的用途，位的表示，位的速率，接口电路的功能，位的传输/接收过程等。
##### 进程通信模式图
* 客户进程和服务器进程使用 TCP/IP 协议进行通信。

![image-20200914210022699](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200914210022699.png)

![image-20200914205849344](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200914205849344.png)

***

# 第二章 物理层
## 1 - 物理层的基本概念
### 1.1 - 物理层的作用
* 将原始的比特流从一台机器传输到另一台机器。
* 尽可能屏蔽掉硬件设备和传输媒体的差异，使物理层上面的数据链路层感觉不到这些差异。
* 确定与传输媒体的接口特性。
### 1.2 - 物理层的特性
* 机械特性：指明接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等等。
* 电气特性：指明在接口电缆的各条线上出现的电压的范围。
* 功能特性：指明某条线上出现的某一电平的电压表示何种意义。
* 过程特性：指明对于不同功能的各种可能事件的出现顺序。 
## 2 - 数据通信的基础知识
### 2.1 - 数据通信系统的模型（拨号上网）

![image-20200927190148923](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927190148923.png)

### 2.2 - 术语解释
* 数据：运送消息的实体。
* 信号：数据的电气的或电磁的表现。
* 模拟：代表消息的参数的取值是连续的。
* 数字：代表消息的参数的取值是离散的。
* 码元：在使用时间域的波形代表数字信号时，代表不同离散数值的基本波形（多个0或1）。
### 2.3 - 通信方式
* 单向通信（单工）
* 双向交替通信（半双工）
* 双向同时通信（全双工）
### 2.4 - 波特和比特的区别

![image-20200927190439015](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927190439015.png)

* Bit是信息量
>如果一个码元含有3个Bit的信息量，那么 1波特 = 3 Bit/s

### 2.5 -  基带信号（基本频带信号）
* 来自信源的信号。像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。
* 含有较多的低频成分，甚至直流成分，不适应物理信道的传输。
### 2.6 - 信号调制
#### 2.6.1 - 基带调制
* 仅仅对基带信号的波形进行变换，使它能够与信道特性相适应。变换后的信号仍然是基带信号。
#### 2.6.2 - 带通调制
* 基带信号经过载波调制后，把信号的频率范围搬移到较高的频段以便在信道中传输（即仅在一段频率范围内能够通过信道）。 

* 最基本的带通调制方法（调幅、调频、调相）

  ![image-202009271911026485C%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927191102648.png)

### 2.7 - 编码特点

![image-20200927191425617](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927191425617.png)

![image-20200927191540290](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927191540290.png)

### 2.8 - 信道极限容量问题
* 任何实际的信道都不是理想的，在传输信号时会产生各种失真以及带来多种干扰。 
* 码元传输的速率越高，或信号传输的距离越远，在信道的输出端的波形的失真就越严重。
* 信道的最大数据传输率：单位时间内能够传输的码元数量。
>信道的带宽或信道中的信噪比越大，则信息的极限传输速率就越高。
>只要信息传输速率低于信道的极限信息传输速率，就一定可以找到某种办法来实现无差错的传输。 
>实际信道上能够达到的信息传输速率要比香农的极限传输速率低不少。

![image-20200927191739406](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927191739406.png)

#### 2.8.1 - Nyquist公式
* 用于无噪声理想低通信道，估算已知带宽信道的最高数据传输速率提供了依据。
* 数据传输率随信号状态数量M增加而增加。
* C = 2 W log~2~M
* C：数据传输率，单位b/s 。
* W：带宽，单位Hz。
* M：信号状态数量
#### 2.8.2 - Shannon公式
* 用于有噪声干扰信道（范围更广）。
* 无论信号状态数量增加到多少，此公式给出了有噪声信道可能达到的最大数据传输速率上限。
* 噪声的存在将使信号状态数量不可能无限增加。
* C = W log~2~（1 + S / N）
* C：传输率，单位b/s。
* W： 带宽，单位Hz。
* S/N：信噪比。
>信噪比的单位也可用分贝(dB)表示： S/NdB=10log10 S/N，所以，若 S/NdB=30dB ，则 S/N=1000。

![image-20200927192728554](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927192728554.png)

## 3 - 物理层下面的传输媒体
* 电信领域使用的电磁波的频谱

![image-20200927192817716](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927192817716.png)

### 3.1 - 双绞线

![image-20200927193037664](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927193037664.png)

* 常用的双绞线：3类（16Mb/s） 和5类（155Mb/s）两种。
#### 3.1.1 - 屏蔽双绞线（STP）
* 以铝箔屏蔽以减少干扰和串音，应用较少。
#### 3.1.2 - 非屏蔽双绞线（UTP）
* 双绞线外无任何屏蔽层，应用广泛。
### 3.2 - 网线
* 自适应接口，同种设备交叉线，异种设备直连线。

![image-20200927193344898](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927193344898.png)

### 3.3 - 同轴电缆

![image-20200927193618917](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927193618917.png)

#### 3.3.1 - 50Ω 同轴电缆 
* 传输数字信号，基带系统的优点是安装简单而且价格便宜，传输距离不能很长。一般在1km以内，典型的传送速率是10Mb每秒。
#### 3.3.2 - 75Ω 同轴电缆
* 用于模拟信号传输，目前主要用于电视信号的传输。
* 由于带宽极宽，也被用于城域网，如有线通，可达100Mb/s。
### 3.4 - 光缆
* 依靠光波承载数据，光脉冲在玻璃纤维中传播。
* 单向传输，双向需两根光纤。
* 应用领域：局域网主干、电信网络、服务器连接。 
* 优点：带宽高，数据传输速率是100Mb每秒，甚至1000Mb每秒，距离远，损耗低，重量轻，无电磁干扰，防窃听，速度快。
* 缺点：设备价格高需要光电转换，不能折。
* 材料：塑料，二氧化硅。
#### 3.4.1 - 多模光缆（MMF) 
* 通过光的反射在光纤中无损传输，距离2km。

![image-20200927194707842](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927194707842.png)

#### 3.4.2 - 单模光缆（SMF）
* 直线传输，距离10km。

![image-20200927194715321](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927194715321.png)

#### 3.4.3 - 单芯光缆

![image-20200927194907079](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927194907079.png)

#### 3.4.4 - 多芯光缆

![image-20200927194926153](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927194926153.png)

### 3.5 - 非导向传输媒体
#### 3.5.1 - 电磁波或光波
* 优缺点
    * 无需物理连接。
    * 适用于长距离或不便布线的场合。
    * 易受干扰。
    * 反射，为障碍物所阻隔。
* 主要类型
    * 无线电、地面微波。
    * 通信卫星。
    * 红外线。
#### 3.5.2 - 地面微波通信
* 传输距离：天线的高度，类型和信号强度。
* 传输可靠性：障碍物。
* 传输正确性：气象条件。
* 通过地面站之间接力传送。
* 接力站之间距离：50 ～100 km。
* 速率：每信道 45 Mb/s。
#### 3.5.3 - 卫星通信
* 与地面站相对固定位置。
* 使用三颗卫星即可覆盖全球。
* 传输延迟时间长（≈270ms）。
* 广播式传输。
* 应用领域：电视传输、长途电话、专用网络、广域网。
#### 3.5.4 - 红外线技术
* 个人无线局域网的应用。
* 红外传输系统利用墙壁或屋顶反射红外线从而形成整个房间内的广播通信系统 。
* 特点
    * 红外通信的设备相对便宜，可获得较高的带宽。
    * 传输距离有限，而且易受室内空气状态（例如有烟雾等）的影响 。
#### 3.5.5 - 短波通信
* 基站与终端之间通信采用无线链路。
* 应用领域：移动通信、无线局域网（WLAN）。
### 3.6 - 常用传输介质的比较

![image-20200927200048925](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200048925.png)

## 4 - 信道复用技术
### 4.1 - 多路复用
* 多个信息源共享一个公共信道。

![image-20200927200248607](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200248607.png)

### 4.2 - 基本思想
* 把公共共享信道用某种方法划分成多个子信道，每个子信道传输一路数据。
### 4.3 - 复用方法
#### 4.3.1 - 频分复用
* 用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带。
* 频分复用的所有用户在同样的时间占用不同的带宽资源。
>这里的“带宽”是频率带宽而不是数据的发送速率。

![image-20200927200632086](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200632086.png)

* 波的特点：互不干扰。

![image-20200927200825864](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200825864.png)

#### 4.3.2 - 时分复用

* 将信道用于传输的时间划分为一段段等长的时分复用帧（TDM 帧）。
* 每一个时分复用的用户在每一个 TDM 帧中占用固定序号的时隙。
* 时分复用的所有用户是在不同的时间占用同样的频带宽度。

![image-20200927200742039](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200742039.png)

* 举例：

![image-20200927200943382](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927200943382.png)

##### 同步时分复用
* 缺点：由于计算机数据的突发性质，用户对分配到的子信道的利用率一般是不高的。

![image-20200927201253588](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927201253588.png)

##### 异步时分复用
* 改进时分复用，尽量塞满。

![image-20200927201330384](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927201330384.png)

#### 4.3.3 - 波分复用

![image-20200927201356974](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927201356974.png)

![image-20200927201415448](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927201415448.png)

#### 4.3.4 - 码分复用（未完）
* 常用名词是码分多址CDMA。
##### 原理
* CDMA为每个结点分配一个唯一的正交的码片序列，发送端A把要发送数字“1” 用自己的码片序列发送出去，数字“0”用码片序列的补码发送出去，接收端也用该码片序列进行解码，因为不同用户发送的信号在接收端被迭加，由于码片的正交性，只有与自己码片序列相关的信号才能被检出，由此恢复出原始数据。
* 地址码序列必须两两相互正交。
* 在无线移动通信中应用广泛。
##### CDMA 的工作原理

![image-20200927201703053](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927201703053.png)

## 5 - 数字传输系统
### 5.1 - 脉冲编码调制（PCM）
* 最初是为了电话局之间的中继线上传送多路电话。
* 把多个话路的PCM语音数据用TDM的方法装成帧（帧中还包括了帧同步信息和信令信息）。
* 每帧在一个时间片内发送。
* 每个时隙承载一路PCM信号。

![image-20200927202221963](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927202221963.png)

### 5.2 - 同步光纤网（SONET）
* 美国1988年推出一个数字传输标准，同步光纤网 SONET (Synchronous Optical Network) 
* 整个同步网络的各级时钟都来自一个非常精确的主时钟。 
* 定义了同步传输的线路速率等级结构。
### 5.3 - 同步数字系列（SDH）
* ITU-T 以美国标准 SONET 为基础，制订出国际标准同步数字系列 SDH (Synchronous Digital Hierarchy)。
* SDH和SONET基本同义，只是速率等级不同 。
## 6 - 宽带接入技术
### 6.1 - 非对称数字用户线（ADSL）
* 用数字技术对现有的模拟电话用户线进行改造，使它能够承载宽带数字业务
上行和下行带宽做成不对称的。
* ADSL 在用户线（铜线）的两端各安装一个 ADSL 调制解调器。
* 我国目前采用的方案是离散多音调 DMT (Discrete Multi-Tone)调制技术。这里的“多音调”就是“多载波”或“多子信道”的意思。

![image-20200927202634649](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927202634649.png)

![image-20200927202900801](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927202900801.png)

#### 6.1.1 - 对称DSL（SDSL）
* 对称平均分配下行和上行两个方向，速度为384Kbit/s或1.5Mbit/s。
#### 6.1.2 - High speed DSL（HDSL）
* 使用一对线或两对线的对称DSL，速度可达768Kbit/s或1.5Mbit/s。
### 6.2 - 光纤同轴混合网（HFC网）

![image-20200927203039110](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927203039110.png)

![image-20200927203104179](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927203104179.png)

#### 6.2.1 - 用户接口盒 UIB 
* 使用同轴电缆连接到机顶盒(set-top box)，然后再连接到用户的电视机。
* 使用双绞线连接到用户的电话机。
* 使用电缆调制解调器连接到用户的计算机。
#### 6.2.2 - 电缆调制解调器
* 为 HFC 网而使用的调制解调器。
* 传输速率高。其下行速率一般在 3~10  Mb/s之间，最高可达 30 Mb/s，而上行速率一般为 0.2~2 Mb/s，最高可达 10 Mb/s。
* 电缆调制解调器比在普通电话线上使用的调制解调器要复杂得多，并且不是成对使用，而是只安装在用户端。
### 6.3 - FTTx 技术
* FTTx（光纤到……）也是一种实现宽带居民接入网的方案。这里字母 x 可代表不同意思。
* 光纤到家：光纤一直铺设到用户家庭可能是居民接入网最后的解决方法。
* 光纤到大楼：光纤进入大楼后就转换为电信号，然后用电缆或双绞线分配到各用户。
* 光纤到路边：从路边到各用户可使用星形结构双绞线作为传输媒体。

***

# 第三章 数据链路层
## 1 - 概述
### 1.1 - 链路
* 链路(link)是一条无源的点到点的物理线路段，中间没有任何其他的交换结点。
* 一条链路只是一条通路的一个组成部分。
#### 1.1.1 - 数据链路
* 数据链路(data link) 除了物理线路外，还必须有通信协议来控制这些数据的传输。若把实现这些协议的硬件和软件加到链路上，就构成了数据链路。
* 现在最常用的方法是使用适配器（即网卡）来实现这些协议的硬件和软件。
* 一般的适配器都包括了数据链路层和物理层这两层的功能。
### 1.2 - 数据链路层的作用
* 在原始的、有差错的物理传输线路上采取差错检测、差错控制等方法。
* 将有差错的物理线路改进成逻辑上无差错的数据链路，向网络层提供高质量服务。
* 数据链路层传送的是帧。

![image-20200927205052131](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927205052131.png)

![image-20200927205208094](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927205208094.png)

### 1.3 - 适配器的作用
* 通信适配器(adapter)或网络接口卡 NIC (Network Interface Card)，或“网卡”。 
* 进行串行/并行转换。
* 对数据进行缓存。
* 在计算机的操作系统安装设备驱动程序。
* 实现以太网协议。

![image-20200927205333688](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927205333688.png)

### 1.4 - 数据链路层协议中的三个基本问题
#### 1.4.1 - 封装成帧
* 封装成帧就是在一段数据的前后分别添加首部和尾部，然后就构成了一个帧。
* 首部和尾部的一个重要作用就是进行帧定界。

![image-20200927210514511](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927210514511.png)

#### 1.4.2 - 透明传输
* 无论什么比特组合的数据都能无差错的通过数据链路层的传输。
* 不是好帧就扔掉，头尾标志尽量不是键盘字符。
* 图片转二进制、特殊字符加料确认一下。

![image-20200927210651508](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927210651508.png)

![image-20200927210748090](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927210748090.png)

#### 1.4.3 - 差错检测
* 在数据链路层传送的帧中，广泛使用了循环冗余检验 CRC
##### 发送端
* 在发送端，先把数据划分为组。假定每组 k 个比特。 
* 假设待传送的一组数据 M = 101001（现在 k = 6）。在 M 的后面再添加供差错检测用的 n 位冗余码一起发送。
##### 冗余码R的计算方法
* 用二进制的模 2 运算进行 2^n^ 乘 M 的运算，这相当于在 M 后面添加 n 个 0。
* 得到的 (k + n) 位的数除以事先选定好的长度为 (n + 1) 位的除数 P，得出商是 Q 而余数是 R，余数 R 比除数 P 少1 位，即 R 是 n 位。
* R=M0…0  mod  p
##### 接收端
* 对接收到的帧进行计算，若得出余数 R = 0，则判定这个帧没有差错，接受。
* 若余数 R！= 0，则判定这个帧有差错，就丢弃。
##### 2进制除法
* 用模2进行加法计算时，不进位，减法同加法一样，按加法计算。
* 加3个0，除数多一位，相同得0，不同得1。
* 举例：帧： M=101001    除数： P = 1101    实际传输帧： 101001**001**（校验）对方除以相同数，除后看是否为0。

![image-20200927211456338](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927211456338.png)

### 1.5 - 两种信道
#### 1.5.1 - 点对点信道
* 使用一对一的点对点通信方式的信道。
#### 1.5.2 - 广播信道
* 广播信道可以进行一对多的通信，例如局域网。
##### 局域网（星型主流）
* 网络为一个单位所拥有，且地理范围和站点数目均有限。 
* 具有广播功能，从一个站点可很方便地访问全网。

![image-20200928004659847](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928004659847.png)

## 2 - 点对点协议PPP
* 现在全世界使用得最多的数据链路层协议是点对点协议 PPP 。
* PPP是Internet标准。
* 用户计算机接入因特网时，一般都是使用 PPP 协议。

![image-20200927211600844](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927211600844.png)

### 2.1 - 优点
* 目前广域网上应用最广泛的协议之一，它的优点在于简单、具备用户验证能力、可以解决IP分配等。
* 能支持数据为8位和无奇偶检验的异步模式（如大多数计算机上都普遍存在的串行接口），还支持面向比特的同步链路。
* 可以支持多种网络层协议。
### 2.2 - 变化
* 家庭拨号上网就是通过PPP在用户端和运营商的接入服务器之间建立通信链路。 
* ADSL宽带接入方式中，PPP与其他的协议共同派生出了符合宽带接入要求的新的协议，如PPPoE（PPP over Ethernet），PPPoA（PPP over ATM）。
### 2.3 - 组成
* 串行链路上封装数据报的方法，既支持异步链路，也支持面向bit的同步链路。
* 扩展的链路控制协议（Link Control Protocol - LCP），用于建立、配置和测试数据链路的连接。
* 网络控制协议（NCP）簇，支持各种网络层协议。
### 2.4 - 帧格式

![image-20200927212001682](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927212001682.png)

#### 2.4.1 - 类型
* 当协议字段为 0x0021 时，PPP 帧的信息字段就是IP 数据报。
* 若为 0xC021, 则信息字段是 PPP 链路控制数据。
* 若为 0x8021，则表示这是网络控制数据。
### 2.5 - 字节填充
* 应用：PPP使用异步传输（逐个字符传送）。
* 将信息字段中出现的每一个 0x7E 字节转变成为 2 字节序列(0x7D, 0x5E)。 
* 若信息字段中出现一个 0x7D 的字节, 则将其转变成为 2 字节序列(0x7D, 0x5D)。
* 若信息字段中出现 ASCII 码的控制字符（即数值小于 0x20 的字符），则在该字符前面要加入一个 0x7D 字节，同时将该字符的编码加以改变。
### 2.6 - 零比特填充

![image-20200927212413823](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200927212413823.png)

#### 2.6.1 - 应用
* PPP在使用 SONET/SDH 链路时同步传输（一连串的比特连续传送）。
#### 2.6.2 - 发送端
* 只要发现有 5 个连续 1，则立即填入一个 0。
#### 2.6.3 - 接收端
* 对帧中的比特流进行扫描，每当发现 5 个连续1时，就把这 5 个连续 1 后的一个 0 删除。（7E避免敏感）。
### 2.7 - 工作状态
* 当用户拨号接入 ISP 时，路由器的调制解调器对拨号做出确认，并建立一条物理连接。
* PC 机向路由器发送一系列的 LCP 分组（封装成多个 PPP 帧）。
* 这些分组及其响应选择一些 PPP 参数，和进行网络层配置，NCP 给新接入的 PC机分配一个临时的 IP 地址，使 PC 机成为因特网上的一个主机。
* 通信完毕时，NCP 释放网络层连接，收回原来分配出去的 IP 地址。接着，LCP 释放数据链路层连接。最后释放的是物理层的连接。

![image-20200928004415757](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928004415757.png)

## 3 - 以太网
### 3.1 - 传统以太网
* 1975年Xerox（美国施乐公司）研制的基带总线LAN。
* 1981年DEC、Intel、 Xerox提出DIX V1。
* 1982年修订DIX Ethernet V2 ，成为世界上第一个局域网产品的规约。
#### 3.1.1 - 标准
* DIX Ethernet V2 。
* IEEE 在此基础上制定了以太网标准IEEE 802.3 标准。
#### 3.1.2 -  曼彻斯特编码
* 数字“1”：码元低电压变高电压。
* 数字“0”：码元高电压变低电压（也可采取相反约定）。
* 保证了在每一个码元的正中间出现电压的跳变，有利于接收端提取位同步信号。

![image-20200928005042338](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928005042338.png)

#### 3.1.3 -  媒体共享技术

![image-20200928005302703](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928005302703.png)

* 静态划分信道（有局限）
    * 频分复用
    * 时分复用
    * 波分复用
    * 码分复用 
* 动态媒体接入控制（多点、随机接入）和复用技术的关系
    * 随机接入（以太网）：所有主机可以随机的发送信息，发生碰撞，所有发送的信息都失败。
    * 受控接入 （令牌环局域网、多点线路探询或轮询）：用户不能随机发送信息，必须服从一定的控制。

#### 3.1.4 -  CSMA/CD
##### 载波监听
* 站点在为发送帧而访问传输信道之前，首先监听信道有无载波，若有载波，说明已有用户在使用信道，则不发送帧以避免冲突。
##### 多路访问
* 多个用户共用一条线路。
##### 碰撞检测
* 计算机边发送数据边检测信道上的信号电压大小，当超过门限值，就表明产生了“碰撞”，即发生了“冲突”。
* 一旦发现总线上出现了碰撞，就要立即停止发送，然后等待一段随机时间后再次发送。
##### 传播时延对载波监听的影响

![image-20200928005750005](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928005750005.png)

* 以太网的端到端往返时延 2τ 称为争用期（往返），或碰撞窗口。
* 经过争用期这段时间还没有检测到碰撞，才能肯定这次发送不会发生碰撞。
* 使用 CSMA/CD 协议的以太网不能进行全双工通信而只能进行半双工通信。
##### 争用期长度
* 以太网取 T=51.2 μs （理想假设）为争用期的长度。
* 对于 10 Mb/s 以太网，在争用期内可发送512 bit，即 64 字节。
* 51.2 * 10^-6^ * 10^6^ * 10 / 8 = 64B
* 以太网在发送数据时，若前 64 字节没有发生冲突，则后续的数据就不会发生冲突。
##### 最短有效帧长
* 由于一检测到冲突就立即中止发送，这时已经发送出去的数据一定小于 64 字节。 
* 以太网规定了最短有效帧长为 64 字节，凡长度小于 64 字节的帧都是由于冲突而异常中止的无效帧（没有传送成功）。
##### 帧间最小间隔
* 以太网规定为9.6 μs，相当于96比特时间，为了做好接收下一帧的准备。
##### 截断二进制指数退避算法
1. 令基本退避时间（争用期长度）T= 2τ
2. k=min（重传次数，10）
3. r=在 [0, 1, …, (2^k^-1)] 中随机取一个数
4. 退避时间= r T
5. 最大重传次数限定为16，若发送16次仍不成功，就放弃发送。
##### 强化碰撞
* 立即停止发送数据，再继续发送若干比特的人为干扰信号，以便所有用户都知道现在发生了碰撞。
### 3.2 - 以太网的信道利用率

![image-20200928010359914](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20200928010359914.png)

* 帧长为 L (bit)，数据发送速率为 C (b/s)，因而帧的发送时间为 L/C = T0 (s)。
### 3.3 - 以太网的帧结构
#### 3.3.1 -硬件地址
* MAC地址，前24位厂家，后24位自行，唯一。
* 实际上就是适配器地址或者适配器标识符EUI-48 。
* 一个站点允许有多个MAC地址，个数取决于该站点网络接口的个数。
##### 安装有多块网卡的计算机
* 有多个以太网接口的路由器。
* MAC地址是在数据链路层进行处理，而不是在物理层。
* IEEE802.3标准规定：MAC地址的长度共48位，高24位由IEEE统一分配给设备生产厂商；低24位由厂商自行分配给所生产的每一块网卡或设备的网络接口。

![image-20201023093933799](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023093933799.png)

#### 3.3.2 - DIX Ethernet V2 的 MAC 帧格式

![image-20201023094058055](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023094058055.png)

![image-20201023094116205](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023094116205.png)

* 类型字段若是0x0800，表示数据字段是来自IP数据报的数据。
* IEEE 802.3 MAC帧的第三个字段是“长度/类型”字段，当字段值大于0x0600时表示“类型”，这样的帧和V2 MAC帧完全一样。小于0x0600时表示“长度”,即MAC帧的数据部分长度。

![image-20201023094355274](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023094355274.png)

![image-20201023094427980](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023094427980.png)

### 3.4 - 扩展的以太网
#### 3.4.1 - 集线器（hub）

![image-20201023095536362](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095536362.png)

![image-20201023095547960](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095547960.png)

* 工作在物理层，是多接口转发器，不进行碰撞检测。
* 逻辑上是总线网，由各站点执行CSMA/CD协议。
##### 双绞线以太网（10Base-T）
* 双绞线（UTP），两头压接RJ45连接器。 
* 所有站点都与HUB （集线器）相连接。
##### HUB的作用
* 信号放大（怕衰竭）与整形。
* 星形拓扑，但逻辑拓扑结构仍然是总线。
* 轻便、安装密度高、便于维护。
#### 3.4.2 - 以太网的标识方法

![image-20201023095310932](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095310932.png)

![image-20201023095340469](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095340469.png)

#### 3.4.3 - 物理层扩展

![image-20201023095606574](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095606574.png)

![image-20201023095617061](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095617061.png)

##### 优点
* 扩大了以太网覆盖的地理范围。
##### 缺点
* 碰撞域增大了，但总的吞吐量并未提高。
* 速率不同时，不能互连。
#### 3.4.4 - 数据链路层扩展
* 更多口的网桥就是交换机。
* 使用的设备是以太网交换机，实质上就是一个多接口的网桥，一般工作在全双工模式。
* 网桥具有过滤帧的功能。当网桥收到一个帧时，并不是向所有的接口转发此帧，而是先检查此帧的目的 MAC 地址，然后再确定将该帧转发到哪一个接口 。
* 以太网交换机是一种即插即用设备，通过自学习算法自动建立帧交换表。
##### 兜圈子问题
* 产生原因：在以太网交换机组网时，为了增加网络的可靠性，往往会增加一些冗余的链路。
* 解决方法：生成树协议（STP）, 要点是不改变网络的实际拓扑，但在逻辑上则切断某些链路，使得任何两台主机之间只有唯一的路径，即无环路的树状结构。

![image-20201023100049165](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023100049165.png)

##### 总线以太网
* 使用CSMA/CD协议，以半双工方式工作。
##### 星型以太网
* 以太网交换机不使用共享总线，没有碰撞问题，因此不使用CSMA/CD协议，而是以全双工方式工作。
* 虽然传统以太网和高速以太网在速率方面、CSMA/CD协议、半双工全双工方面的使用上有差别，但都使用以太网的帧格式，所以仍以以太网为名称。
##### 以太网交换机
* 优点：用户通信时独占传输媒体的带宽，无碰撞的传输数据，可互连不同速率（如10 Mb/s 和 100 Mb/s 以太网）的局域网。
* 缺点：带有缓冲区的以太网交换机，会增加时延；直通交换机转发速度快，但没有检查差错的功能。
#### 3.4.5 - 交换机（网桥）（自学习算法）
* 查找转发表中与收到帧的源地址有无相匹配的项目。如没有，就在转发表中增加一个项目（源地址、进入的接口和时间）。如有，则把原有的项目进行更新。
* 查找转发表中与收到帧的目的地址有无相匹配的项目。如没有，则通过所有其他接口（但进入的接口除外）进行转发。如有，则按转发表中给出的接口进行转发。若转发表中给出的接口就是该帧进入网桥的接口，则应丢弃这个帧（因为这时不需要经过网桥进行转发）。

![image-20201023095907618](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023095907618.png)

#### 3.4.6 - 虚拟局域网(VLAN)
* IEEE 802.1Q定义的虚拟局域网
* 由一些局域网网段构成的与物理位置无关的逻辑组。这些网段具有某些共同的需求。每一个 VLAN 的帧都有一个明确的标识符，指明发送这个帧的工作站是属于哪一个 VLAN。

![image-20201023100306576](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023100306576.png)

##### 虚拟局域网使用的以太网帧格式
* IEEE 802.1Q帧
* 当数据链路层检测到MAC帧的源地址字段后面的两个字节的值是0x8100，就知道现在插入了4个字节的VLAN标记。

![image-20201023100527672](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023100527672.png)

#### 3.4.7 - 高速以太网
* 速率达到或超过 100 Mb/s 的以太网称为高速以太网。
##### 100BASE-T以太网
* 在双绞线上传送 100 Mb/s 基带信号的星型拓扑以太网，仍使用 IEEE 802.3 的CSMA/CD 协议。又称为快速以太网(Fast Ethernet)。 
* 100BASE-T的网卡能够自动识别10Mb/s和100Mb/s.
* 1995年IEEE把100BASE-T以太网定为正式标准，名为IEEE 802.3U.
#### G比特以太网
* 允许在 1 Gb/s 下全双工和半双工两种方式工作。
* 使用 802.3 协议规定的帧格式。
* 在半双工方式下使用 CSMA/CD 协议（全双工方式不需要使用 CSMA/CD 协议）。
* 与 10BASE-T 和 100BASE-T 技术向后兼容。
* 1997年定为IEEE 802.3Z
##### 10G比特以太网
* 10 吉比特以太网与 10 Mb/s，100 Mb/s 和 1 Gb/s 以太网的帧格式完全相同。
* 10 吉比特以太网还保留了 802.3 标准规定的以太网最小和最大帧长，便于升级。
* 10 吉比特以太网不再使用铜线而只使用光纤作为传输媒体。
* 10 吉比特以太网只工作在全双工方式，因此没有争用问题，也不使用 CSMA/CD 协议
* 使用以太网进行宽带接入
##### PPPoE(PPP over Ethernet)
* 在以太网上运行PPP，把PPP协议中的PPP帧再封装到以太网中来传输。现在的光纤宽带接入FTTx 都要使用PPPoE的方式进行接入。

***
# 第四章 网络层
## 1 - 网络层作用
### 1.1 - 互联网的设计思路
* 为上层提供简单灵活的、无连接的、尽最大努力交付的数据报服务。
    * 无连接（分散发出去就行）每个数据报的处理都是相互独立的，可以不按发送顺序接收。
    * 不可靠（有可能丢包）不能保证IP数据报能成功到达目的地。发现错误丢弃数据报并返回ICMP消息。可靠性由上层提供。
* 提供路由和寻址的功能，使两终端系统能够互连且决定最佳路径
* 核心是IP协议，配套使用实现其功能的还有地址解析协议ARP、逆地址解析协议RARP、网际控制报文协议ICMP、网际组管理协议IGMP。
## 2 -  网络设计思路
### 2.1 - 面向连接的通信方式（虚电路） 
* 电路交换的电话通信是先建立了一条真正的物理连接。
* 虚电路表示这只是一条逻辑上的连接，分组都沿着这条逻辑连接按照存储转发方式传送，而并不是真正建立了一条物理连接。
* 可以实现按序到达，不丢失数据报，可靠传输。（ITU-T的X.25）

![image-20201022104409718](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104409718.png)

### 2.2 - 面向无连接的通信方式（数据报）
* 互联网采用的设计思路：分组交换传输网络。
* 传输网络不提供端到端的可靠传输服务，使得网络中的路由器比较简单，网络造价大大降低。

![image-20201022104425300](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104425300.png)

## 3 - 网际协议IP
### 3.1 - 虚拟互联网
* 不同的物理网络存在异构性，虚拟互连网络能够屏蔽物理网络的异构性。
* 利用 IP 协议使得在网络层上看起来像是一个统一的网络。或简称为 IP 网。
* 网络互连使用路由器，当中继系统是集线器或网桥时，一般并不称之为网络互连，仅仅把一个网络扩大了。
* 可称为逻辑互联网络，当互联网上的主机进行通信时，就好像在一个网络上通信一样，而看不见互连的各具体的网络异构细节。

![image-20201022104652693](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104652693.png)

![image-20201022104733920](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104733920.png)

![image-20201022104801665](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104801665.png)

### 3.2 - 编址方法阶段

![image-20201022104931568](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022104931568.png)

### 3.3 - 分类
* IP地址就是给每个连接在因特网上的主机（或路由器）分配一个在全世界范围是唯一的 32 位的标识符。
* IP地址现在由因特网名字与号码指派公司ICANN 进行分配。
* 点分十进制记法。

![image-20201022105434979](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022105434979.png)

#### 3.3.1 - 两级的 IP 地址

![image-20201022105453535](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022105453535.png)

#### 3.3.2 - 网络号字段和主机号字段

![image-20201022105509599](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201022105509599.png)

### 3.4 - 特点
* 采用网络号和主机号两部分组成的分等级的地址结构。
* 方便 IP 地址的分配与管理。
* 减小路由表所占的存储空间。
* IP 地址是标志一个主机(或路由器)和一条链路的接口。
* 主机连接两个网络,必须有两个IP地址,叫多归属主机。
* 一个路由器至少应当有两个不同的 IP 地址。
* 用转发器或网桥连接起来的局域网仍为一个网络。
* 所有分配到网络号 net-id 的网络，无论大小都是平等的。
### 3.5 - 类型
#### 3.5.1 - A类地址

![image-20201023085530960](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085530960.png)

* IP地址空间共有2^32^个地址，整个A类地址空间共有2^31^个地址，占整个IP地址空间的50%。
##### 网络号字段
* 可指派的网络号是126个（2^7^-2）。
* 网络号字段全0的IP地址为保留地址，指“本网络”。
* 网络号为127（01111111）保留作为本地软件环回测试用的。
##### 主机号字段
* 主机号占3个字节，每一个A类网络中的最大主机数是2^24^-2，即16777214.
* 全0的主机号字段表示该IP 地址是“本主机”所在的网络地址。
* 全1的主机号字段，表示该网络上的所有主机。
#### 3.5.2 - B类地址

![image-20201023085551801](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085551801.png)

* IP地址空间共有2^32^个地址，整个B类地址空间共有2^30^个地址，占整个IP地址空间的25%。
##### 网络号字段
* 可指派的网络号有14位，是16383个（2^14^-1）。
* 128.0.0.0 是不指派的。
* B类最小的网络地址是128.1.0.0。
##### 主机号字段
* 主机号字段为16位，每一个B类网络中的最大主机数是2^16^-2，即65534。
* 全0的主机号字段表示该IP 地址是“本主机”所在的网络地址。
* 全1的主机号字段，表示该网络上的所有主机。
#### 3.5.3 - C类地址

![image-20201023085609883](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085609883.png)

* IP地址空间共有2^32^个地址，整个C类地址空间共有2^29^个地址，占整个IP地址空间的12.5%。
##### 网络号字段
* 可指派的网络号有21位，是2097151（2^21^-1）。
* 192.0.0.0是不指派的，最小的C类最小网络地址是192.0.1.0。
* 主机号占8位，每一个C类网络中的最大主机数是2^8^-2，即254。
* 全0和全1的主机号不被指派。
##### 主机号字段
* 主机号占3个字节，每一个A类网络中的最大主机数是2^24^-2，即16777214.
* 全0的主机号字段表示该IP 地址是“本主机”所在的网络地址。
* 全1的主机号字段，表示该网络上的所有主机。
#### 3.5.4 - 特殊类型

![image-20201023085724338](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085724338.png)

##### 私有IP地址
* A 类地址中:10.0.0.0 到10.255.255.255.
* B 类地址中:172.16.0.0 到172.31.255.255。
* C 类地址中:192.168.0.0 到  192.168.255.255  （宿舍、实验室、企业常见，家装路由器）。
* 私有地址不能直接在网络上运行。
* 私有地址转换成共有地址NAT。
##### 特殊IP地址
* IP 地址127.0.0.1：本地回环(loopback)测试地址(自测开发程序)，127开头，都是环回。
* 广播地址:255.255.255.255。
* IP 地址0.0.0.0:代表任何网络（默认路由）。
* 节点号全为1:代表该网段的所有主机。
* 广播地址TCP/IP 协议规定,主机号部分各位全为1 的IP 地址用于广播.所谓广播地址指同时
向网上所有的主机发送报文,也就是说,不管物理网络特性如何,Internet 网支持广播传输.如136.78.255.255 就是B 类地址中的一个广播地址,你将信息送到此地址,就是将信息送给网络号为136.78 的所有主机。
#### 3.5.5 - 总结

![image-20201023085704223](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085704223.png)

### 3.6 - 网络中的IP地址
* 同一个局域网上的IP地址中的网络号必须是一样的。
* 网桥（工作在数据链路层）互连的网段仍然是一个局域网，只能有一个网络号。
* 路由器每个接口都有一个不同网络号的IP地址。
* 两个路由器直接相连时，可以分配也可不分配IP地址。

![image-20201023085913828](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023085913828.png)

### 3.7 - 子网掩码
* 子网掩码默认值可以在配置中自动生成。
* “/16” 表示子网掩码有16位，“/24”表示子网掩码有24位。
* 利用子网掩码划分子网。
* 
#### 3.7.1 - 子网划分
##### 为什么要划分子网
* IP分类不合理，地址空间利用率低。
    * 美国的某些机构拥有的地址空间甚至比其他一些国家的全部地址空间还大。
* 每个网络都指定一个网络地址将使路由表太大。
    * 增加了路由器成本。
    * 查找路由耗时增加。
    * 路由器之间交换的路由信息增加。
* 两级IP地址不够灵活，不能充分利用已申请到的地址资源扩充新的网络。
##### 划分子网的方法
* 从IP地址的主机编号部分“借用”若干位作为子网编号，主机编号部分相应缩短 , 使两级IP地址变成三级IP地址。

![image-20201023091536918](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091536918.png)

* 例如：原来的网络：138.5.0.0，借用2位划分子网后：138.5.64.0 和 138.5.128.0。 

![](C:%5CUsers%5CMr_CH%5COnC%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091550810.png)

![image-20201023091615689](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091615689.png)

![image-20201023091631379](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091631379.png)

* 多个子网可以运行在同一物理网络上。
* 划分子网后，原来的网络对外仍呈现为一个完整的网络，外面看不见其内部的子网结构。
* 划分子网已成为互联网的正式标准协议（RFC 950)。
##### 没划分子网的网络

![image-20201023091818539](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091818539.png)

##### 划分子网后的网络

![image-20201023091838162](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023091838162.png)

#### 3.7.2 - 子网掩码的作用
* 使网络内的计算机了解子网划分的结构。
* 使边缘路由器了解子网划分的结构。
#### 3.7.3 - 子网掩码的格式
子网掩码也是32bit长的二进制数，由一串连续的1后跟一串连续的0组成。
前面的1与网络号和子网号对应，后面的0与主机号对应。如前面的例子。
||net-id|net-id|subnet-id|host-id|host-id|
|:-:|:-:|:-:|:-:|:-:|:-:|
|子网结构|10001010|00000101|cc|xxxxxx|xxxxxxxx|
|子网掩码|11111111|11111111|11|000000|00000000|
|十进制数| 255|255||192|0|
#### 3.7.4 - 求网络地址
||net-id|net-id|subnet-id|host-id|host-id|
|:-:|:-:|:-:|:-:|:-:|:-:|
|三级IP地址|aaaaaaaa|bbbbbbbb|cc|xxxxxx|xxxxxxxx|
|子网掩码|11111111|11111111|11|000000|00000000|
|运算方式|AND运算|AND运算|AND运算|AND运算|AND运算|
|子网网络地址|aaaaaaaa|bbbbbbbb|cc|000000|00000000|
##### 例子

![image-20201023093610726](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023093610726.png)

#### 3.7.5 - 默认子网掩码

![image-20201023093630776](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.assets%5Cimage-20201023093630776.png)

## 4 - ARP地址解析协议
## 5 - ICMP网际控制报文协议
## 6 - 互联网的路由选择协议
## 7 - IP多播和IGMP网际组管理协议
## 8 - 虚拟专用网VPN和网络地址转换NAT
## 9 - 多协议标记交换MPLS
## 10 - IPv6

# 第五章 运输层

***

# 第六章 应用层

***

# 第七章 无线网络

***

